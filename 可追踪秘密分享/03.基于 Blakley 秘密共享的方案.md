
### 4 基于 Blakley 秘密共享的方案

在本节中，我们展示了如何在 Blakley 开创性秘密共享方案 [6] 的一个变体中追踪泄漏。我们首先提出了 Blakley 原始方案的扩展版本。随后，我们为该扩展方案展示了一种非常高效的追踪算法。

#### 4.1 扩展的 Blakley 方案

我们首先回顾 Blakley 的原始方案 [6]，然后介绍我们扩展的方案。

##### Blakley 原始方案及其局限性

在 Blakley 的方案中，秘密被编码为有限域 $F_p^t$ 中某点的一个坐标，其中 $p$ 是适当选择的模数，$t$ 是阈值。具体而言，分发者（dealer）选择一个随机点 $x \in F_p^t$，条件是其第一个坐标 $x_1$ 等于秘密 $s \in F_p$。随后，分发者为每个参与方 $i$ 分配一个均匀随机的超平面 $H_i \subset F_p^t$，使其通过点 $x$。

当模数 $p$ 足够大时，任意 $t$ 个分配的超平面以高概率会相交于一个唯一的点。由于所有超平面均设计为通过点 $x$，这一唯一的交点必然是 $x$。

关于保密性，注意到任意 $k$ 个超平面的交集是一个维度至少为 $t-k$ 的子空间。因此，当 $k < t$ 时，这一子空间的维度至少为 1。假设为了简单起见，该子空间的维度恰好为 1，即它是 $F_p^t$ 中的一条直线 $\ell$。如果 $\ell$ 不垂直于第一个坐标轴（这种情况发生的概率非常小），则 $\ell$ 上的所有点的第一个坐标都不同。

直观上，这意味着直线 $\ell$ 不会泄露点 $x$ 的第一个坐标的任何信息，因此不会泄露秘密 $s \in F_p$。我们将在扩展 Blakley 方案时对这一点进行严格论证。

然而，在我们的追踪程序中，我们需要将秘密编码为 $F_p^t$ 中的一个完整点。Blakley 方案的一个简单扩展可能会将秘密 $s \in F_p^t$ 直接设置为所有超平面的交点。然而，这种简单扩展完全不安全！注意，即使只有一个超平面（即一个共享）也会泄露大量关于秘密的信息，因为它仅包含 $F_p^t$ 中点的 $1/p$ 的比例。

更一般地讲，可以很容易地看出，如果我们将秘密设置为交点 $x \in F_p^t$ 的前 $k$ 个坐标，那么只需 $t-k+1$ 个超平面就能泄露关于秘密的信息。


### 翻译

#### 扩展的 Blakley 方案

为了避免上述的简单扩展，我们采用了一种更精巧的方法，通过引入更多的随机性，将秘密“分散”到交点 $x$ 的多个分量中。具体来说，假设我们希望将秘密编码为 $F_p^t$ 中的一个完整点。其核心思想是使用标准的加法秘密共享方式，将秘密 $s$ 随机分成 $t$ 份 $r_1, \ldots, r_t$，满足：

$$r_1, \ldots, r_t \text{ 在 } F_p^t \text{ 中均匀随机，且 } r_1 + r_2 + \cdots + r_t = s。$$

随后，我们使用前述 Blakley 方案的简单扩展分别共享这些 $r_i$。具体来说，第 $i$ 个秘密共享现在包括 $t$ 个随机超平面 $H_i^{(1)}, \ldots, H_i^{(t)}$，这些超平面分别通过 $r_1, \ldots, r_t$。

---

#### 方案的安全性

从安全性的角度来看，可以将 $t$ 次“简单 Blakley”实例视为发生在 $F_p^t$ 的 $t$ 个正交子空间中。任何 $t-1$ 个参与方的集合持有 $F_p^{t^2}$ 中的 $t \cdot (t-1)$ 个超平面。这种设置能够精确隐藏 $F_p$ 中的 $t$ 个元素。

直观上，这是因为每个“候选秘密” $s^* \in F_p^t$ 增加了 $t$ 个关于 $F_p^t$ 的仿射方程，因此由该秘密和 $t \cdot (t-1)$ 个超平面诱导的仿射方程组包含恰好 $t^2$ 个方程。这意味着方程组不具有过度约束性，从而使 $s^*$ 成为可能的解。

正式的分析需要更复杂的证明过程。

---

#### 方案细节

我们将该方案称为 **Blakley+**，其参数化由一个函数 $p = p(n, t, \lambda)$ 决定，该函数定义了有限域的大小。秘密共享算法的输入包括：
- $n$：参与方数量；
- $t$：阈值；
- 一个秘密向量 $s \in F_p^t$；
- 一个相关性字符串 $\rho$，其被解释为用于对 $s$ 进行加法秘密共享的随机性。

Blakley+ 方案通过这种随机分散和扩展共享的方法，增强了原始方案的安全性，同时确保可以通过一定数量的共享进行秘密重建。