
### 摘要

​ ​**顺序揭示加密 (Order-Revealing Encryption, ORE)​**​ 是一种用于**加密数据库外包**的原语，它允许在加密数据上高效执行范围查询。不幸的是，自 Naveed 等人 (CCS 2015) 的开创性工作以来，一系列研究表明：​**当攻击者能较好估计数据分布时，ORE 提供的保护非常有限。​**​ 在本研究中，我们考虑一种情况：​**数据库条目是独立同分布（i.i.d.）地从某一已知形态的分布中抽取的，但其均值与方差未知（因此 Naveed 等人的攻击不适用）。​**​ 我们为 ORE ​**定义了一种新的安全概念——参数隐藏型 ORE (parameter-hiding ORE)​**，它能**保密这些分布参数 (均值和方差)​**。我们**基于双线性映射 (bilinear maps)​**给出了满足我们新定义的 ORE ​**构造方案**。

---

​**重点标注说明：​**​

1. ​**顺序揭示加密 (Order-Revealing Encryption, ORE)​**​：核心研究对象，允许在不解密的情况下比较加密数据的大小顺序，是支持加密数据库高效范围查询的关键技术。
2. ​**加密数据库外包 (outsourcing encrypted databases)​**​：ORE 的应用场景。
3. ​**范围查询 (range queries)​**​：ORE 支持的关键操作。
4. ​**攻击背景 (当攻击者...保护非常有限)​**​：指出**传统 ORE 存在的严重安全缺陷**，特别是在攻击者具备数据分布知识的情况下防护性不足。这是本研究要解决的问题。
5. ​**研究场景设定 (数据库条目...均值与方差未知)​**​：本研究聚焦的特定场景。关键点是：
    - ​**独立同分布 (i.i.d.)​**​：数据生成方式假设。
    - ​**分布形态已知**​：攻击者知道数据属于哪类分布（如：正态分布）。
    - ​**均值与方差未知**​：分布的关键参数对攻击者和数据库（用户）都保密。正是**参数未知性**使得之前的攻击失效，并成为新方案保护的要点。
6. ​**Naveed 等人的攻击不适用**​：强调在_当前研究设定的场景下_，之前成功的攻击方法失效了，为新方案提供了基础。
7. ​**新安全概念—参数隐藏型 ORE (parameter-hiding ORE)​**​：​**本研究的主要贡献之一**。定义了一种更强的 ORE 安全目标，要求不仅要隐藏明文数据，还要隐藏用于生成数据的分布参数（均值和方差）。
8. ​**保密这些分布参数 (均值和方差)​**​：新安全概念的具体保护目标。
9. ​**构造方案**​：​**本研究的主要贡献之二**。提出了一种实际的实现方法。
10. ​**基于双线性映射 (bilinear maps)​**​：构造方案所依赖的**核心密码学工具**。这暗示该新方案可能需要更强的计算假设（双线性群），计算开销可能比传统 ORE 大，但也带来了更强的安全性。

好的，这是该段密码学文本的翻译，并对关键概念、技术挑战和研究贡献进行了重点标注：

### ​​ 一、 简介

密码学的一个新兴领域关注“泄漏式”协议（leaky protocols）的设计与分析（参见例[11,33,36]及下方更多参考文献）。这类协议**刻意牺牲一定级别的安全性以换取更高的效率**。该领域的一个重要工具是**顺序揭示加密（Order-Revealing Encryption, ORE）​**​[7,8]。

顺序揭示加密（ORE）是一种特殊类型的对称加密。它通过一个**公共比较过程 `Comp`，泄漏了底层明文的顺序关系**。在实际应用中，ORE 允许客户端以**加密形式将数据库存储于不受信任的服务器上**，同时仍**允许服务器高效地执行各种操作（例如对加密数据的范围查询）​**，而无需掌握秘密解密密钥。ORE ​**已被实现并应用于实际的加密数据库系统**中，包括 CryptDB [36]。

目前提出了各种 ORE 安全概念。​**最强大的概念被称为“理想”ORE（ideal ORE）​**，它要求除了明文的顺序之外，​**其他关于明文的一切信息都必须隐藏**。例如，应该无法区分序列 1, 2, 3 和序列 1, 4, 9 的密文。这种理想的 ORE ​**可以通过多线性映射（multilinear maps）​**​[8] 来构造，​**在理论上是可实现的**。然而，​**当前的多线性映射效率极低**，并且**已遭受众多攻击（例[16,17,32]）​**。

为了开发**高效的方案**，可以**放宽安全要求，允许更多信息泄漏**。保序加密（Order-Preserving Encryption, OPE）[1,6]——实际上它早于 ORE 出现——就是这样一个例子，其 `Comp` 过程就是简单的整数比较。目前已有**非常高效的 OPE 构造方案**​[6]。但是，OPE ​**必然比理想 ORE 泄漏多得多的明文信息**​[6]；直观地说，密文之间的差异可被用于近似推断明文之间的差异。最近，人们致力于在不牺牲过多效率的情况下实现更好的安全性：Chenette, Lewi, Weis 和 Wu (CLWW) [15] ​**近期提出了一种 ORE 构造方案，它仅泄漏明文中最高有效位差异的位置信息**。

不幸的是，​**即使假设的理想 ORE 最近也被证明在各种实际用例下不安全**​[3,10,19,20,22,24–26,30,34]。​**即使方案本身除了明文顺序外不泄漏任何信息，问题依然存在。问题根源在于，仅凭明文的顺序本身就已经能揭示数据的大量信息**。例如，如果数据是从整个定义域中均匀选择的，那么即使是理想 ORE ​**也会泄漏最高有效位**​（most significant bits）。由于最高有效位通常是最重要的部分，这令人担忧。

问题在于，ORE 的定义虽然精确且可证明，​**却并不能直接为底层数据的隐私提供任何“语义上有意义”（semantically meaningful）的保证**。诚然，上述攻击表明，当**攻击者对数据来自的【先验分布】（prior distribution）有很强的估计时，基本上无法提供任何安全性**。然而，​**我们主张存在攻击者缺乏这种知识的场景**​（见下文）。在此类场景中，一个核心问题是：​**一条消息的隐私性本质上依赖于攻击者能看到的其他密文**。即使对于理想的 ORE，在任意的数据来源下分析这些相关性也相当困难。目前仅有一些**非常初步的结论**​（very mild results）为人所知，例如：CLWW 的泄漏模式或理想泄漏模式，​**可证明地隐藏了均匀选择数据的最低有效位**​（least significant bits）。不幸的是，这些位可能不那么重要（例如对于工资数据）。

​**因此，本文的一个核心目标是：针对攻击者对先验分布没有强估计的情况，为底层数据设计一种语义上有意义的隐私概念，并开发一种不依赖多线性映射的构造方案以实现这个概念。​**​

我们**重点强调：我们并非试图设计一种能抵御上述所有攻击的普适性安全方案**，因为上述许多攻击**适用于任何 ORE 方案**；**我们的目标在于找到那些攻击不适用（do not apply）的环境/场景（settings），然后在此环境下提供能满足特定安全概念的方案**。

---

​**重点标注说明：​**​

1. ​**​“泄漏式”协议 (Leaky Protocols)​**​：核心研究方向，核心特点是**效率优先、有控制地接受安全损失**。
2. ​**顺序揭示加密 (ORE) 的作用**​：是 leaky protocols 的关键工具，实现**外包加密数据库**上的**高效范围查询**。
3. ​**ORE 机制**​：​**公共比较过程 `Comp`**​ 是关键操作，其**泄漏明文顺序**。
4. ​**现实应用**​：​**CryptDB**​ 等系统**已验证 ORE 的实际价值**。
5. ​**安全概念谱系**​：
    - ​**​“理想” ORE (Ideal ORE)​**​：​**理论上的最强安全目标**​（只泄漏顺序）。
    - ​**现有实现路径**​：​**多线性映射 (Multilinear Maps)​**​ ​**理论上可行但实际效率低、易受攻击**。
    - ​**放宽安全的实践方案**​：
        - ​**保序加密 (OPE)​**​：​**高效但泄漏信息过多**​（数值间隔），安全性**显著弱于理想 ORE**。
        - ​**CLWW 方案**​：​**安全性与效率的折中**，仅泄漏**最高位差异位置**，代表近年**平衡实践的努力方向**。
6. ​**ORE 的核心安全困境**​：
    - ​**即使“理想” ORE 也非万能**​：仅凭顺序信息本身**在特定数据分布下会泄漏关键信息（如最高有效位）​**。
    - ​**现有定义的局限性**​：​**缺乏“语义上有意义”的保证 (Semantically Meaningful Guarantees)​**。精确的形式化安全定义**不能直接映射到实际数据的隐私保护强度**。
    - ​**攻击的根本条件**​：攻击者掌握**数据来源的【先验分布】(Prior Distribution) 信息**是导致 ORE 失效的关键。
    - ​**关联隐私的复杂性 (Inherent Dependency)​**​：单个消息的隐私**取决于攻击者可见的密文集**，分析难度大。
    - ​**现有安全结论的局限**​：只证明了对**最不重要（最低有效位）信息**的某些保护，​**实用性受限**。
7. ​**本文研究目标与思路（核心贡献点）​**​：
    - ​**目标1 (定义新安全概念)​**​：​**针对攻击者缺乏先验分布知识的环境**，​**定义一种“语义上有意义”的隐私概念**。
    - ​**目标2 (设计新方案)​**​：​**构造一种满足上述概念、且不依赖多线性映射的 ORE 方案**。
    - ​**核心研究思路创新**​：​**不再追求抵御所有攻击的普适安全方案**​（作者认为这不现实），转而**识别并限定那些既有攻击无效的场景 (Settings)​**，​**专注于在这些特定场景中设计并证明其方案的安全性**。这是一种**更具针对性和现实可行性的研究路径**。


#### ​ **1.1 本文工作：参数隐藏可排序加密 (ORE)​**
​
​**动机示例 (Motivating Example)。​**​ 为了阐明我们的概念，考虑以下场景。一所大型大学希望将其学生 GPA 数据库外包。为简化起见，我们假设每个学生的学术能力独立于其他学生，并且这反映在 GPA 中。因此，我们假设每个 GPA 是根据某个底层分布独立同分布 (iid) 采样的。该大学显然希望隐藏每个学生的个人 GPA。它也可能希望隐藏诸如均值和方差等聚合统计信息，或许是为了避免获得发放极高或极低分数的声誉。

​**定理 1（非正式）(Theorem 1 (Informal))。​**​ 假设存在双线性映射，对于任何“平滑 (smooth)”的分布 D，只要缩放项“足够大 (large enough)”，就可以构造参数隐藏的 ORE。

---

​**重点总结 (Key Points Summary):​**​

1. ​**核心问题与动机 (Core Problem & Motivation):​**​
    
    - 传统 ORE 关注单个记录的隐私（比较顺序）。
    - 本文关注**数据底层分布 D 的隐私**​（例如 GPA 的分布）。
    - 动机：外包数据库（如大学 GPA）时，既要隐藏个体记录，也要隐藏聚合统计信息（均值、方差）以避免声誉问题。
2. ​**分布隐藏 ORE (Distribution-Hiding ORE):​**​
    
    - ​**目标：​**​ 完全隐藏数据来源的分布 D（所有数据 iid 采样自 D）。
    - ​**理想情况：​**​ 如果 D 具有**高最小熵 (high min-entropy)​**​（超对数级），则理想 ORE 泄露仅是一个随机顺序（无等值），这本身就隐藏了 D（除了最小熵的下界）。
    - ​**限制：​**​ 最小熵要求是关键。若最小熵低（如 GPA 熵 < 10 bits），泄露会揭示最常见元素的频率（即 D 的信息）。
    - ​**缓解低熵问题：​**​ 可在加密前添加**微小噪声**​（不影响顺序精度），人为提高最小熵（使相同值比较时不等），这在许多应用（如范围查询）是可接受的。
    - ​**构造困难：​**​ 目前已知的唯一构造基于**多线性映射 (multilinear maps)​**，且依赖理想泄露模型。
3. ​**参数隐藏 ORE (Parameter-Hiding ORE):​**​
    
    - ​**核心思想：​**​ 对分布隐藏 ORE 的**实用化放松 (practical relaxation)​**。承认分布的**​“形状” (shape)​**​（如正态、均匀）通常是已知或可猜测的（如 GPA 近似正态，保险索赔用伽马分布）。
    - ​**目标：​**​ 隐藏分布的**参数**——**缩放项 α (scaling term)​**​ 和**平移项 β (shift term)​**。即，对于形如 `Dα,β(x) = α * D(x) + β` 的分布族（其中 D 是定义在 [0,1] 上的“形状”分布），方案应隐藏 α 和 β。
    - ​**主要成果 (Theorem 1):​**​ 基于**双线性映射 (bilinear maps)​**，可以构造参数隐藏 ORE。
    - ​**构造前提：​**​
        - 形状分布 D 需要是**​“平滑” (smooth)​**​ 的（定义为导数有界）。
        - 缩放项 α 需要**​“足够大” (large enough)​**。
    - ​**前提原因：​**​
        - ​**α 足够大：​**​ 确保缩放后的分布具有高最小熵（小 α 导致低最小熵，泄露信息）。
        - ​**D 平滑：​**​ 技术分析需要，且保证在大 α 下确实具有高最小熵。

​本文提出了一种新型的可排序加密（ORE）变体——**参数隐藏 ORE**。它针对的场景是数据来源于一个**已知“形状”但参数未知的分布**​（如正态分布，但均值和方差未知）。目标是设计 ORE 方案，在允许比较加密数据顺序的同时，​**完全隐藏决定该分布位置和尺度的关键参数（平移 β 和缩放 α）​**。作者证明了基于双线性映射可以构造这样的方案，但要求分布本身是“平滑”的，并且缩放参数必须足够大以保证底层分布具有足够的最小熵，从而避免信息泄露。这项工作为在保护数据整体分布特征隐私的前提下进行加密数据排序和查询提供了新的思路。


---


**攻击背景 (当攻击者...保护非常有限)​**​：指出**传统 ORE 存在的严重安全缺陷**，特别是在攻击者具备数据分布知识的情况下防护性不足。
- **研究场景设定 (数据库条目...均值与方差未知)​**​：本研究聚焦的特定场景。关键点是：
    - ​**独立同分布 (i.i.d.)​**​：数据生成方式假设。
    - ​**分布形态已知**​：攻击者知道数据属于哪类分布（如：正态分布）。
    - ​**均值与方差未知**​：分布的关键参数对攻击者和数据库（用户）都保密。正是**参数未知性**使得之前的攻击失效，并成为新方案保护的要点。

<style scoped>
section p {font-size: 36px;color:black;}
</style>

---

 - ​**新安全概念—参数隐藏型 ORE (parameter-hiding ORE)​**​：​**本研究的主要贡献之一**。定义了一种更强的 ORE 安全目标，要求不仅要隐藏明文数据，还要隐藏用于生成数据的分布参数（均值和方差）。**保密这些分布参数 (均值和方差)​**​：新安全概念的具体保护目标。
- ​**构造方案**​：​**本研究的主要贡献之二**。提出了一种实际的实现方法。**基于双线性映射 (bilinear maps)​**​：构造方案所依赖的**核心密码学工具**。这暗示该新方案可能需要更强的计算假设（双线性群），计算开销可能比传统 ORE 大，但也带来了更强的安全性。

<style scoped>
section p {font-size: 36px;color:black;}
</style>
---

**ORE 的核心安全困境**​：
    1. ​**即使“理想” ORE 也非万能**​：仅凭顺序信息本身**在特定数据分布下会泄漏关键信息（如最高有效位）​**。
    2. ​**现有定义的局限性**​：​**缺乏“语义上有意义”的保证 (Semantically Meaningful Guarantees)​**。精确的形式化安全定义**不能直接映射到实际数据的隐私保护强度**。
    3. ​**攻击的根本条件**​：攻击者掌握**数据来源的【先验分布】(Prior Distribution) 信息**是导致 ORE 失效的关键。
    4. ​**关联隐私的复杂性 (Inherent Dependency)​**​：单个消息的隐私**取决于攻击者可见的密文集**，分析难度大。
    5. ​**现有安全结论的局限**​：只证明了对**最不重要（最低有效位）信息**的某些保护，​**实用性受限**。

---
 ​**本文研究目标与思路（核心贡献点）​**​：
    1. ​**目标1 (定义新安全概念)​**​：​**针对攻击者缺乏先验分布知识的环境**，​**定义一种“语义上有意义”的隐私概念**。
    2. ​**目标2 (设计新方案)​**​：​**构造一种满足上述概念、且不依赖多线性映射的 ORE 方案**。
    
​**核心研究思路创新**​：​**不再追求抵御所有攻击的普适安全方案**​（作者认为这不现实），转而**识别并限定那些既有攻击无效的场景 (Settings)​**，​**专注于在这些特定场景中设计并证明其方案的安全性**。这是一种**更具针对性和现实可行性的研究路径**。